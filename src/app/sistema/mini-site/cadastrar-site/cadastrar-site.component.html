<section class="main-container">
  <div class="cadastro-titulo">
    <h1>
      <a [routerLink]="['/usuario/meu-perfil-profissional']">
        <img src="/assets/icones/voltar-icon.svg" />
      </a>
      {{ isEditMode ? 'Editar Site' : 'Cadastrar Site' }}
    </h1>
  </div>

  <section class="inputs-cadastro">
    <form
      [formGroup]="siteForm"
      (ngSubmit)="onSubmit()"
      class="container-form"
      autocomplete="off"
      (keydown.enter)="$event.preventDefault()"
    >

      <!-- CAMPO UPLOAD DA FOTO DE PERFIL -->
      <div id="campo-valor">
        <label class="form-label">
          Foto do Perfil
        </label>
        <app-input-img label="Clique ou arraste a foto para fazer upload. " 
        inputId="fotoPerfil" 
        (imageSelected)="onImageSelected($event, 'fotoPerfil')" 
        [fotoPreview]="fotoPerfilPreview">
        </app-input-img>
        <p class="upload-info">Tamanho recomendado: 400x400 pixels.</p>
      </div>


      <!-- CAMPO UPLOAD DO BANNER -->
      <div id="campo-valor">
        <label class="form-label">
          Banner do Perfil
        </label>
        <app-input-img label="Clique ou arraste a foto para fazer upload" 
        inputId="banner" 
        (imageSelected)="onImageSelected($event, 'banner')" 
        [fotoPreview]="bannerPreview">
        </app-input-img>
        <p class="upload-info">Tamanho recomendado: 1390x233 pixels.</p>
      </div>
      
      <div id="campo-valor">
        <label class="required" for="nome">Nome</label>
        <input
          id="nome"
          type="text"
          formControlName="nome"
          placeholder="Digite seu nome"
        />
      </div>


    <div id="campo-descricao">
        <label class="required" for="bio">Bio</label>
        <textarea 
        name="bio" 
        formControlName="bio" 
        id="input-descricao" 
        placeholder="Digite uma breve descrição." rows="4"
        (keydown.enter)="$event.stopPropagation()" ></textarea>
    </div>

    <div id="campo-valor">
        <label class="form-label">
          Vídeo de Apresentação <span>(opcional)</span>
        </label>
        <app-input-video label="Clique ou arraste o video para fazer upload" inputId="video"  [maxDurationSeconds]="30"  (validationError)="errorMessage = $event" (videoSelected)="onVideoSelected($event, 'video')" [videoPreview]="videoPreview"></app-input-video>
    </div>

    <div id="campo-valor">
        <label class="required" for="experiencia">Tempo de experiência</label>
        <input type="text" id="input-valor" (keypress)="allowOnlyNumbers($event)"  formControlName="tempoExperiencia" name="tempoExperiencia" placeholder="Digite o tempo">
    </div>

    <div id="campo-valor">
        <label class="required" for="valor">Habilidades</label>

        <div class="skills-input" (click)="skillInput?.focus()">
          <span class="chip" *ngFor="let s of skills; let i = index">
            {{ s }}
            <button type="button" class="chip-remove" (click)="removeSkill(i)" aria-label="Remover skill">&times;</button>
          </span>

          <input
            #skillInput
            type="text"
            [formControl]="skillsCtrl"
            placeholder="Digite e pressione Enter para adicionar a sua Skill"
            autocomplete="off"
            (keydown.enter)="addSkill($event)"
            (keydown)="onSkillKeydown($event)"
            (blur)="commitSkill()"
          />
        </div>

        <!-- mantém o formControl original “oculto” para validação/envio -->
        <input type="hidden" formControlName="skills" />
        <small class="hint">Enter ou “,” adiciona; Backspace remove a última.</small>


    </div>


      <!-- MENSAGENS -->
      <div class="alert ">
        <div
          class="alert-success"
          *ngIf="successMessage"
        >
          {{ successMessage }}
        </div>
        <div
          class="alert-danger"
          *ngIf="errorMessage"
        >
          {{ errorMessage }}
        </div>
      </div>
      
      <div class="progress-bar-container" *ngIf="isLoading">
        <div class="progress-bar"></div>
      </div>

      <!-- BOTÃO DE SUBMIT -->
      <button id="btn-cadastrar-projeto" type="submit">
        {{ isEditMode ? 'Salvar alterações' : 'Cadastrar alterações' }}
      </button>
    </form>
  </section>
</section>
